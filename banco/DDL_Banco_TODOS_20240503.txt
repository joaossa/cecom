-- cecom.cargos definition

-- Drop table

-- DROP TABLE cecom.cargos;

CREATE TABLE cecom.cargos (
	codigo int2 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 32767 START 1 CACHE 1 NO CYCLE) NOT NULL,
	descricao varchar(50) NOT NULL,
	"cdNivel" int4 NULL,
	"stInativo" varchar(1) DEFAULT 'N'::character varying NULL,
	CONSTRAINT cargos_pkey PRIMARY KEY (codigo)
);

-- Permissions

ALTER TABLE cecom.cargos OWNER TO postgres;
GRANT ALL ON TABLE cecom.cargos TO postgres;


-- cecom.escolaridades definition

-- Drop table

-- DROP TABLE cecom.escolaridades;

CREATE TABLE cecom.escolaridades (
	codigo int2 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 32767 START 1 CACHE 1 NO CYCLE) NOT NULL,
	descricao varchar(50) NOT NULL,
	stinativo varchar(1) DEFAULT 'N'::character varying NULL, -- S-Sim N-Não
	CONSTRAINT ck_st_stinativoescol CHECK (((stinativo)::text = ANY (ARRAY['S'::text, 'N'::text]))),
	CONSTRAINT escolaridades_pkey PRIMARY KEY (codigo)
);

-- Column comments

COMMENT ON COLUMN cecom.escolaridades.stinativo IS 'S-Sim N-Não';

-- Permissions

ALTER TABLE cecom.escolaridades OWNER TO postgres;
GRANT ALL ON TABLE cecom.escolaridades TO postgres;


-- cecom.horarios definition

-- Drop table

-- DROP TABLE cecom.horarios;

CREATE TABLE cecom.horarios (
	cd_horario int2 NOT NULL,
	st_usorestrito bpchar(1) NULL, -- S-Sim N-Não
	ds_horario varchar(50) NOT NULL,
	hr_inicio timestamptz NOT NULL,
	hr_fim timestamptz NULL,
	st_inativo bpchar(1) NULL, -- S-Sim N-Não
	CONSTRAINT ckc_st_inativo_horarios CHECK (((st_inativo)::text = ANY (ARRAY['S'::text, 'N'::text]))),
	CONSTRAINT ckc_st_usorestrito_horarios CHECK (((st_usorestrito)::text = ANY (ARRAY['S'::text, 'N'::text]))),
	CONSTRAINT horarios_pkey PRIMARY KEY (cd_horario)
);

-- Column comments

COMMENT ON COLUMN cecom.horarios.st_usorestrito IS 'S-Sim N-Não';
COMMENT ON COLUMN cecom.horarios.st_inativo IS 'S-Sim N-Não';

-- Permissions

ALTER TABLE cecom.horarios OWNER TO postgres;
GRANT ALL ON TABLE cecom.horarios TO postgres;


-- cecom.locaisatendimentos definition

-- Drop table

-- DROP TABLE cecom.locaisatendimentos;

CREATE TABLE cecom.locaisatendimentos (
	codigo int2 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 32767 START 1 CACHE 1 NO CYCLE) NOT NULL,
	descricao varchar(100) NOT NULL,
	"siglaUnidade" varchar(10) NULL,
	endereco varchar(150) NULL,
	telefone varchar(50) NULL,
	CONSTRAINT locaisatendimentos_pkey PRIMARY KEY (codigo)
);

-- Permissions

ALTER TABLE cecom.locaisatendimentos OWNER TO postgres;
GRANT ALL ON TABLE cecom.locaisatendimentos TO postgres;


-- cecom.motivosdesistencia definition

-- Drop table

-- DROP TABLE cecom.motivosdesistencia;

CREATE TABLE cecom.motivosdesistencia (
	codigo int2 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 32767 START 1 CACHE 1 NO CYCLE) NOT NULL,
	descricao varchar(50) NOT NULL,
	CONSTRAINT motivosdesistencia_pkey PRIMARY KEY (codigo)
);

-- Permissions

ALTER TABLE cecom.motivosdesistencia OWNER TO postgres;
GRANT ALL ON TABLE cecom.motivosdesistencia TO postgres;


-- cecom.motivosexclamacao definition

-- Drop table

-- DROP TABLE cecom.motivosexclamacao;

CREATE TABLE cecom.motivosexclamacao (
	codigo int2 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 32767 START 1 CACHE 1 NO CYCLE) NOT NULL,
	descricao varchar(50) NOT NULL,
	stinativo varchar(1) DEFAULT 'N'::character varying NULL, -- S-Sim N-Não
	CONSTRAINT ck_st_stinativomotivo CHECK (((stinativo)::text = ANY (ARRAY['S'::text, 'N'::text]))),
	CONSTRAINT motivosexclamacao_pkey PRIMARY KEY (codigo)
);

-- Column comments

COMMENT ON COLUMN cecom.motivosexclamacao.stinativo IS 'S-Sim N-Não';

-- Permissions

ALTER TABLE cecom.motivosexclamacao OWNER TO postgres;
GRANT ALL ON TABLE cecom.motivosexclamacao TO postgres;


-- cecom.ocupacoes definition

-- Drop table

-- DROP TABLE cecom.ocupacoes;

CREATE TABLE cecom.ocupacoes (
	codigo int2 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 32767 START 1 CACHE 1 NO CYCLE) NOT NULL,
	descricao varchar(250) NOT NULL,
	ocupacao varchar(10) NULL,
	cd_ocupacaopai int2 NULL,
	"stInativo" varchar(1) DEFAULT 'N'::character varying NULL,
	CONSTRAINT ocupacoes_pkey PRIMARY KEY (codigo)
);

-- Permissions

ALTER TABLE cecom.ocupacoes OWNER TO postgres;
GRANT ALL ON TABLE cecom.ocupacoes TO postgres;


-- cecom.paises definition

-- Drop table

-- DROP TABLE cecom.paises;

CREATE TABLE cecom.paises (
	codigo int2 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 32767 START 1 CACHE 1 NO CYCLE) NOT NULL,
	descricao varchar(35) NOT NULL,
	nacionalidade varchar(50) NULL,
	"cdIbge" int4 NULL,
	CONSTRAINT paises_pkey PRIMARY KEY (codigo)
);

-- Permissions

ALTER TABLE cecom.paises OWNER TO postgres;
GRANT ALL ON TABLE cecom.paises TO postgres;


-- cecom.planos definition

-- Drop table

-- DROP TABLE cecom.planos;

CREATE TABLE cecom.planos (
	codigo int2 NOT NULL,
	descricao varchar(50) NOT NULL,
	valor money NOT NULL,
	qtd_profissinais int2 NOT NULL,
	qtd_clinicas int2 NOT NULL,
	validade_inicio timestamptz NOT NULL,
	validade_final timestamptz NULL,
	st_inativo bpchar(1) NULL, -- S-Sim N-Não
	CONSTRAINT ckc_st_inativo_horarios CHECK (((st_inativo)::text = ANY (ARRAY['S'::text, 'N'::text]))),
	CONSTRAINT planos_pkey PRIMARY KEY (codigo)
);

-- Column comments

COMMENT ON COLUMN cecom.planos.st_inativo IS 'S-Sim N-Não';

-- Permissions

ALTER TABLE cecom.planos OWNER TO postgres;
GRANT ALL ON TABLE cecom.planos TO postgres;


-- cecom.tiposevolucoes definition

-- Drop table

-- DROP TABLE cecom.tiposevolucoes;

CREATE TABLE cecom.tiposevolucoes (
	codigo int2 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 32767 START 1 CACHE 1 NO CYCLE) NOT NULL,
	descricao varchar(50) NOT NULL,
	CONSTRAINT tiposevolucoes_pkey PRIMARY KEY (codigo)
);

-- Permissions

ALTER TABLE cecom.tiposevolucoes OWNER TO postgres;
GRANT ALL ON TABLE cecom.tiposevolucoes TO postgres;


-- cecom.tiposprocedimentos definition

-- Drop table

-- DROP TABLE cecom.tiposprocedimentos;

CREATE TABLE cecom.tiposprocedimentos (
	codigo int2 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 32767 START 1 CACHE 1 NO CYCLE) NOT NULL,
	descricao varchar(50) NOT NULL,
	CONSTRAINT tiposprocedimentos_pkey PRIMARY KEY (codigo)
);

-- Permissions

ALTER TABLE cecom.tiposprocedimentos OWNER TO postgres;
GRANT ALL ON TABLE cecom.tiposprocedimentos TO postgres;


-- cecom.tiposrecebimento definition

-- Drop table

-- DROP TABLE cecom.tiposrecebimento;

CREATE TABLE cecom.tiposrecebimento (
	codigo int2 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 32767 START 1 CACHE 1 NO CYCLE) NOT NULL,
	descricao varchar(50) NOT NULL,
	CONSTRAINT tiposrecebimento_pkey PRIMARY KEY (codigo)
);

-- Permissions

ALTER TABLE cecom.tiposrecebimento OWNER TO postgres;
GRANT ALL ON TABLE cecom.tiposrecebimento TO postgres;


-- cecom.unidadesfederacao definition

-- Drop table

-- DROP TABLE cecom.unidadesfederacao;

CREATE TABLE cecom.unidadesfederacao (
	codigo bpchar(2) NOT NULL,
	descricao varchar(100) NOT NULL,
	CONSTRAINT unidadesfederacao_pkey PRIMARY KEY (codigo)
);

-- Permissions

ALTER TABLE cecom.unidadesfederacao OWNER TO postgres;
GRANT ALL ON TABLE cecom.unidadesfederacao TO postgres;


-- cecom.cidades definition

-- Drop table

-- DROP TABLE cecom.cidades;

CREATE TABLE cecom.cidades (
	codigo int2 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 32767 START 1 CACHE 1 NO CYCLE) NOT NULL,
	descricao varchar(100) NOT NULL,
	"cdUf" bpchar(2) NOT NULL,
	"cdPais" int2 NOT NULL,
	"cepGeral" varchar(9) NOT NULL,
	"cdIbge" int4 NULL,
	"stInativo" varchar(1) DEFAULT 'N'::character varying NULL,
	CONSTRAINT cidades_pkey PRIMARY KEY (codigo),
	CONSTRAINT cidades_cdpais_foreign FOREIGN KEY ("cdPais") REFERENCES cecom.paises(codigo),
	CONSTRAINT cidades_cduf_foreign FOREIGN KEY ("cdUf") REFERENCES cecom.unidadesfederacao(codigo)
);

-- Permissions

ALTER TABLE cecom.cidades OWNER TO postgres;
GRANT ALL ON TABLE cecom.cidades TO postgres;


-- cecom.enderecos definition

-- Drop table

-- DROP TABLE cecom.enderecos;

CREATE TABLE cecom.enderecos (
	codigo int4 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 2147483647 START 1 CACHE 1 NO CYCLE) NOT NULL,
	enderecoresidencia varchar(125) NULL,
	nr_residencia varchar(10) NULL,
	complementoresidencia varchar(100) NULL,
	bairroresidencia varchar(100) NULL,
	cep_residencia varchar(10) NULL,
	"cdCidadeResidencia" int4 NOT NULL,
	"dtAtualizacao" timestamptz DEFAULT CURRENT_TIMESTAMP NULL,
	telefone varchar(10) NOT NULL,
	tp_pessoalcontato bpchar(1) NULL,
	ddd int2 NULL,
	nm_contato varchar(100) NULL,
	tp_fone bpchar(1) NULL,
	CONSTRAINT ckc_tp_fone_telefone CHECK (((tp_fone)::text = ANY (ARRAY['R'::text, 'T'::text, 'C'::text, 'P'::text]))),
	CONSTRAINT ckc_tp_pessoalcontato_telefone CHECK (((tp_pessoalcontato)::text = ANY (ARRAY['P'::text, 'C'::text]))),
	CONSTRAINT pessoas_pkey PRIMARY KEY (codigo),
	CONSTRAINT enderecos_cdcidaderesidencia_foreign FOREIGN KEY ("cdCidadeResidencia") REFERENCES cecom.cidades(codigo)
);

-- Permissions

ALTER TABLE cecom.enderecos OWNER TO postgres;
GRANT ALL ON TABLE cecom.enderecos TO postgres;


-- cecom.gruposcid definition

-- Drop table

-- DROP TABLE cecom.gruposcid;

CREATE TABLE cecom.gruposcid (
	cd_grupocid int4 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 2147483647 START 1 CACHE 1 NO CYCLE) NOT NULL,
	ds_grupocid varchar(250) NOT NULL,
	cd_grupocidpai int4 NULL,
	versao int2 NULL, -- 9-CID9 10-CID10
	CONSTRAINT ckc_versao_gruposci CHECK (((versao IS NULL) OR (versao = ANY (ARRAY[9, 10])))),
	CONSTRAINT gruposcid_pkey PRIMARY KEY (cd_grupocid),
	CONSTRAINT fk_gruposci_gruposci FOREIGN KEY (cd_grupocidpai) REFERENCES cecom.gruposcid(cd_grupocid)
);

-- Column comments

COMMENT ON COLUMN cecom.gruposcid.versao IS '9-CID9 10-CID10';

-- Permissions

ALTER TABLE cecom.gruposcid OWNER TO postgres;
GRANT ALL ON TABLE cecom.gruposcid TO postgres;


-- cecom.gruposdsm definition

-- Drop table

-- DROP TABLE cecom.gruposdsm;

CREATE TABLE cecom.gruposdsm (
	cd_grupodsm int4 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 2147483647 START 1 CACHE 1 NO CYCLE) NOT NULL,
	ds_grupodsm varchar(250) NOT NULL,
	cd_grupodsmpai int4 NULL,
	versao int2 NULL, -- 4-DSM-4 5-DSM-5
	CONSTRAINT ckc_versao_gruposdsm CHECK (((versao IS NULL) OR (versao = ANY (ARRAY[4, 5])))),
	CONSTRAINT gruposdsm_pkey PRIMARY KEY (cd_grupodsm),
	CONSTRAINT fk_gruposdsm_gruposdsm FOREIGN KEY (cd_grupodsmpai) REFERENCES cecom.gruposdsm(cd_grupodsm)
);

-- Column comments

COMMENT ON COLUMN cecom.gruposdsm.versao IS '4-DSM-4 5-DSM-5';

-- Permissions

ALTER TABLE cecom.gruposdsm OWNER TO postgres;
GRANT ALL ON TABLE cecom.gruposdsm TO postgres;


-- cecom.master definition

-- Drop table

-- DROP TABLE cecom.master;

CREATE TABLE cecom.master (
	codigo int4 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 2147483647 START 1 CACHE 1 NO CYCLE) NOT NULL,
	codigomaster int4 NOT NULL,
	nome varchar(50) NOT NULL,
	email varchar(200) NOT NULL,
	dt_atualizacao timestamptz DEFAULT CURRENT_TIMESTAMP NULL,
	"password" varchar(255) NOT NULL,
	"admin" bool DEFAULT false NOT NULL,
	CONSTRAINT master_email_unique UNIQUE (email),
	CONSTRAINT master_pkey PRIMARY KEY (codigo),
	CONSTRAINT master_codigomaster_foreign FOREIGN KEY (codigomaster) REFERENCES cecom.master(codigo)
);

-- Permissions

ALTER TABLE cecom.master OWNER TO postgres;
GRANT ALL ON TABLE cecom.master TO postgres;


-- cecom.pacientes definition

-- Drop table

-- DROP TABLE cecom.pacientes;

CREATE TABLE cecom.pacientes (
	codigomaster int4 NOT NULL,
	codigopaciente int4 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 2147483647 START 1 CACHE 1 NO CYCLE) NOT NULL,
	nomepaciente varchar(100) NOT NULL,
	codigoocupacao int2 NULL,
	dt_admissao timestamptz NULL,
	cd_escolaridade int2 NULL,
	nm_responsavel varchar(100) NULL,
	tp_parentesco bpchar(1) DEFAULT 'R'::bpchar NOT NULL, -- P-Pai M-Mae T-Tutor legal F-Filho(a) C-Conjuge O-Outro R-Sou o paciente
	cd_escolaridaderesponsavel int2 NULL,
	codigoocupacaoresponsavel int2 NULL,
	cpfresponsavel varchar(14) NULL,
	CONSTRAINT ckc_tp_parentesco CHECK (((tp_parentesco)::text = ANY (ARRAY['P'::text, 'M'::text, 'T'::text, 'F'::text, 'C'::text, 'O'::text, 'R'::text]))),
	CONSTRAINT pacientes_pkey PRIMARY KEY (codigomaster, codigopaciente),
	CONSTRAINT fk_pacientes_master_foreign FOREIGN KEY (codigomaster) REFERENCES cecom.master(codigo),
	CONSTRAINT paciente_escolaresp_foreign FOREIGN KEY (cd_escolaridaderesponsavel) REFERENCES cecom.escolaridades(codigo),
	CONSTRAINT paciente_escolaridade_foreign FOREIGN KEY (cd_escolaridade) REFERENCES cecom.escolaridades(codigo),
	CONSTRAINT paciente_ocupacoe_foreign FOREIGN KEY (codigoocupacao) REFERENCES cecom.ocupacoes(codigo),
	CONSTRAINT paciente_ocupacoemresp_foreign FOREIGN KEY (codigoocupacaoresponsavel) REFERENCES cecom.ocupacoes(codigo)
);

-- Column comments

COMMENT ON COLUMN cecom.pacientes.tp_parentesco IS 'P-Pai M-Mae T-Tutor legal F-Filho(a) C-Conjuge O-Outro R-Sou o paciente';

-- Permissions

ALTER TABLE cecom.pacientes OWNER TO postgres;
GRANT ALL ON TABLE cecom.pacientes TO postgres;


-- cecom.profissionais definition

-- Drop table

-- DROP TABLE cecom.profissionais;

CREATE TABLE cecom.profissionais (
	codigoprof int4 NOT NULL,
	nome varchar(50) NOT NULL,
	sexo text NOT NULL,
	dtnascimento timestamptz NOT NULL,
	cpf varchar(11) NOT NULL,
	rg varchar(15) NULL,
	orgaoemissor varchar(10) NULL,
	codigocargo int2 NULL,
	cd_situacao bpchar(1) NULL,
	dt_admissao timestamptz NULL,
	dt_demissao timestamptz NULL,
	apelido varchar(20) NULL,
	entidadeclasse varchar(100) NULL,
	conselhoprofissional varchar(7) NULL,
	email varchar(200) NOT NULL,
	"nmCivil" varchar(50) NULL,
	"stNmSocial" varchar(1) DEFAULT 'N'::character varying NULL,
	CONSTRAINT profissionais_cpf_unique UNIQUE (cpf),
	CONSTRAINT profissionais_email_unique UNIQUE (email),
	CONSTRAINT profissionais_pkey PRIMARY KEY (codigoprof),
	CONSTRAINT profissionais_sexo_check CHECK ((sexo = ANY (ARRAY['M'::text, 'F'::text, 'I'::text]))),
	CONSTRAINT fk_profissionais_cargos FOREIGN KEY (codigocargo) REFERENCES cecom.cargos(codigo),
	CONSTRAINT fk_profissionais_master_foreign FOREIGN KEY (codigoprof) REFERENCES cecom.master(codigo)
);

-- Permissions

ALTER TABLE cecom.profissionais OWNER TO postgres;
GRANT ALL ON TABLE cecom.profissionais TO postgres;


-- cecom.prontuariospacientes definition

-- Drop table

-- DROP TABLE cecom.prontuariospacientes;

CREATE TABLE cecom.prontuariospacientes (
	prontuario bpchar(7) NOT NULL,
	codigopac int4 NOT NULL,
	codigopaciente int4 NOT NULL,
	dt_aberturaprontuario timestamptz NULL,
	st_inativo bpchar(1) NULL,
	CONSTRAINT ckc_st_inativo_prontuar CHECK (((st_inativo)::text = ANY (ARRAY['S'::text, 'N'::text]))),
	CONSTRAINT pk_prontuariospacientes PRIMARY KEY (codigopac, codigopaciente, prontuario),
	CONSTRAINT fk_prontpac_foreign FOREIGN KEY (codigopac,codigopaciente) REFERENCES cecom.pacientes(codigomaster,codigopaciente)
);

-- Permissions

ALTER TABLE cecom.prontuariospacientes OWNER TO postgres;
GRANT ALL ON TABLE cecom.prontuariospacientes TO postgres;


-- cecom.quadrosvagas definition

-- Drop table

-- DROP TABLE cecom.quadrosvagas;

CREATE TABLE cecom.quadrosvagas (
	cd_quadrovaga int4 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 2147483647 START 1 CACHE 1 NO CYCLE) NOT NULL,
	codigoprof int4 NOT NULL,
	dt_vaga timestamptz NOT NULL,
	cd_horario int2 NOT NULL,
	codigolocalatend int2 NOT NULL,
	CONSTRAINT quadrosvagas_pkey PRIMARY KEY (cd_quadrovaga),
	CONSTRAINT fk_quadrosvagas_horarios_foreign FOREIGN KEY (cd_horario) REFERENCES cecom.horarios(cd_horario),
	CONSTRAINT fk_quadrosvagas_locatend_foreign FOREIGN KEY (codigolocalatend) REFERENCES cecom.locaisatendimentos(codigo),
	CONSTRAINT fk_quadrosvagas_prof FOREIGN KEY (codigoprof) REFERENCES cecom.profissionais(codigoprof)
);

-- Permissions

ALTER TABLE cecom.quadrosvagas OWNER TO postgres;
GRANT ALL ON TABLE cecom.quadrosvagas TO postgres;


-- cecom.unidadesorganizacionais definition

-- Drop table

-- DROP TABLE cecom.unidadesorganizacionais;

CREATE TABLE cecom.unidadesorganizacionais (
	codigo int2 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 32767 START 1 CACHE 1 NO CYCLE) NOT NULL,
	descricao varchar(100) NOT NULL,
	"siglaUnidade" varchar(10) NULL,
	endereco varchar(150) NULL,
	telefone varchar(50) NULL,
	"cdCidade" int2 NOT NULL,
	CONSTRAINT unidadesorganizacionais_pkey PRIMARY KEY (codigo),
	CONSTRAINT unidadesorganizacionais_cdcidade_foreign FOREIGN KEY ("cdCidade") REFERENCES cecom.cidades(codigo)
);

-- Permissions

ALTER TABLE cecom.unidadesorganizacionais OWNER TO postgres;
GRANT ALL ON TABLE cecom.unidadesorganizacionais TO postgres;


-- cecom.agendaprofissionais definition

-- Drop table

-- DROP TABLE cecom.agendaprofissionais;

CREATE TABLE cecom.agendaprofissionais (
	cd_agenda int4 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 2147483647 START 1 CACHE 1 NO CYCLE) NOT NULL,
	codigoprof int4 NOT NULL,
	nomepaciente varchar(100) NOT NULL,
	telefonepaciente varchar(50) NOT NULL,
	emailpaciente varchar(200) NULL,
	codigopacientemaster int4 NULL,
	codigopaciente int4 NULL,
	dt_agendamento timestamptz NOT NULL,
	cd_horario int2 NOT NULL,
	codigolocalatend int2 NOT NULL,
	motivodesistencia int2 NULL,
	codigovaga int4 NULL,
	CONSTRAINT agendaprofissionais_pkey PRIMARY KEY (cd_agenda, codigoprof),
	CONSTRAINT fk_agendaprofissionais_paciente FOREIGN KEY (codigopacientemaster,codigopaciente) REFERENCES cecom.pacientes(codigomaster,codigopaciente),
	CONSTRAINT fk_agendaprofissionais_prof FOREIGN KEY (codigoprof) REFERENCES cecom.profissionais(codigoprof),
	CONSTRAINT fk_agendprof_horarios_foreign FOREIGN KEY (cd_horario) REFERENCES cecom.horarios(cd_horario),
	CONSTRAINT fk_agendprof_locatend_foreign FOREIGN KEY (codigolocalatend) REFERENCES cecom.locaisatendimentos(codigo),
	CONSTRAINT fk_agendprof_motivo_foreign FOREIGN KEY (motivodesistencia) REFERENCES cecom.motivosdesistencia(codigo),
	CONSTRAINT fk_agendprof_qudvg_foreign FOREIGN KEY (codigovaga) REFERENCES cecom.quadrosvagas(cd_quadrovaga)
);

-- Permissions

ALTER TABLE cecom.agendaprofissionais OWNER TO postgres;
GRANT ALL ON TABLE cecom.agendaprofissionais TO postgres;


-- cecom.arquivosassinados definition

-- Drop table

-- DROP TABLE cecom.arquivosassinados;

CREATE TABLE cecom.arquivosassinados (
	cd_arquivoassinado int4 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 2147483647 START 1 CACHE 1 NO CYCLE) NOT NULL,
	arquivo bytea NULL,
	codigoprof int4 NOT NULL,
	dt_operacao timestamptz NULL,
	ds_assinador varchar(200) NULL, -- Nome e cpf do assinador (token)
	CONSTRAINT arqassprof_pkey PRIMARY KEY (codigoprof, cd_arquivoassinado),
	CONSTRAINT fk_enderecosprof_prof_foreign FOREIGN KEY (codigoprof) REFERENCES cecom.profissionais(codigoprof)
);

-- Column comments

COMMENT ON COLUMN cecom.arquivosassinados.ds_assinador IS 'Nome e cpf do assinador (token)';

-- Permissions

ALTER TABLE cecom.arquivosassinados OWNER TO postgres;
GRANT ALL ON TABLE cecom.arquivosassinados TO postgres;


-- cecom.assinaturas definition

-- Drop table

-- DROP TABLE cecom.assinaturas;

CREATE TABLE cecom.assinaturas (
	codigoassinante int4 NOT NULL,
	codigoplano int4 NOT NULL,
	codigo int4 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 2147483647 START 1 CACHE 1 NO CYCLE) NOT NULL,
	valorcontratado money NOT NULL,
	percentualdesconto int2 NULL,
	dt_contratacao timestamptz DEFAULT CURRENT_TIMESTAMP NOT NULL,
	dt_distrato timestamptz NULL,
	CONSTRAINT assinaturas_pkey PRIMARY KEY (codigoassinante, codigoplano, codigo),
	CONSTRAINT fk_assinaturas_master_foreign FOREIGN KEY (codigoassinante) REFERENCES cecom.master(codigo),
	CONSTRAINT fk_assinaturasplano_foreign FOREIGN KEY (codigoplano) REFERENCES cecom.planos(codigo)
);

-- Permissions

ALTER TABLE cecom.assinaturas OWNER TO postgres;
GRANT ALL ON TABLE cecom.assinaturas TO postgres;


-- cecom.cid_master definition

-- Drop table

-- DROP TABLE cecom.cid_master;

CREATE TABLE cecom.cid_master (
	cd_cid_master int4 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 2147483647 START 1 CACHE 1 NO CYCLE) NOT NULL,
	cd_cid10 varchar(7) NULL,
	ds_cid10 varchar(250) NOT NULL,
	cd_cid_masterpai int4 NOT NULL,
	cd_grupocid int4 NOT NULL,
	versao int2 NULL, -- 9-CID9 10-CID10
	st_inativo bpchar(1) DEFAULT 'N'::character varying NOT NULL,
	CONSTRAINT cid_master_pkey PRIMARY KEY (cd_cid_master),
	CONSTRAINT ckc_st_inativo_cid_master CHECK (((st_inativo)::text = ANY (ARRAY['S'::text, 'N'::text]))),
	CONSTRAINT ckc_versao_cid_master CHECK (((versao IS NULL) OR (versao = ANY (ARRAY[9, 10])))),
	CONSTRAINT fk_cid_master_gruposci FOREIGN KEY (cd_grupocid) REFERENCES cecom.gruposcid(cd_grupocid),
	CONSTRAINT fk_cidsarahpai FOREIGN KEY (cd_cid_masterpai) REFERENCES cecom.cid_master(cd_cid_master)
);

-- Column comments

COMMENT ON COLUMN cecom.cid_master.versao IS '9-CID9 10-CID10';

-- Permissions

ALTER TABLE cecom.cid_master OWNER TO postgres;
GRANT ALL ON TABLE cecom.cid_master TO postgres;


-- cecom.contasreceber definition

-- Drop table

-- DROP TABLE cecom.contasreceber;

CREATE TABLE cecom.contasreceber (
	codigoprof int4 NOT NULL,
	codigopacientemaster int4 NOT NULL,
	codigopaciente int4 NOT NULL,
	dt_realizacaoconsulta timestamptz NOT NULL,
	codigolocalatend int2 NOT NULL,
	valoratendimento money NOT NULL,
	CONSTRAINT contasreceber_pkey PRIMARY KEY (codigoprof, codigopacientemaster, codigopaciente),
	CONSTRAINT fk_contasreceber_locatend_foreign FOREIGN KEY (codigolocalatend) REFERENCES cecom.locaisatendimentos(codigo),
	CONSTRAINT fk_contasreceber_paciente FOREIGN KEY (codigopacientemaster,codigopaciente) REFERENCES cecom.pacientes(codigomaster,codigopaciente),
	CONSTRAINT fk_contasreceber_prof FOREIGN KEY (codigoprof) REFERENCES cecom.profissionais(codigoprof)
);

-- Permissions

ALTER TABLE cecom.contasreceber OWNER TO postgres;
GRANT ALL ON TABLE cecom.contasreceber TO postgres;


-- cecom.dsm_master definition

-- Drop table

-- DROP TABLE cecom.dsm_master;

CREATE TABLE cecom.dsm_master (
	cd_dsm_master int4 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 2147483647 START 1 CACHE 1 NO CYCLE) NOT NULL,
	cd_dsm varchar(7) NULL,
	ds_dsm varchar(250) NOT NULL,
	cd_dsm_masterpai int4 NOT NULL,
	cd_grupodsm int4 NOT NULL,
	cd_cidrelaciondo varchar(7) NULL,
	versao int2 NULL, -- 4-DSM-4 5-DSM-5
	st_inativo bpchar(1) DEFAULT 'N'::character varying NOT NULL,
	CONSTRAINT ckc_st_inativo_dsm_master CHECK (((st_inativo)::text = ANY (ARRAY['S'::text, 'N'::text]))),
	CONSTRAINT ckc_versao_dsm_master CHECK (((versao IS NULL) OR (versao = ANY (ARRAY[4, 5])))),
	CONSTRAINT dsm_master_pkey PRIMARY KEY (cd_dsm_master),
	CONSTRAINT fk_cidsarahpai FOREIGN KEY (cd_dsm_masterpai) REFERENCES cecom.dsm_master(cd_dsm_master),
	CONSTRAINT fk_dsm_master_gruposdsm FOREIGN KEY (cd_grupodsm) REFERENCES cecom.gruposdsm(cd_grupodsm)
);

-- Column comments

COMMENT ON COLUMN cecom.dsm_master.versao IS '4-DSM-4 5-DSM-5';

-- Permissions

ALTER TABLE cecom.dsm_master OWNER TO postgres;
GRANT ALL ON TABLE cecom.dsm_master TO postgres;


-- cecom.enderecospacientes definition

-- Drop table

-- DROP TABLE cecom.enderecospacientes;

CREATE TABLE cecom.enderecospacientes (
	codigomaster int4 NOT NULL,
	codigopaciente int4 NOT NULL,
	codigoendereco int4 NOT NULL,
	"dtAtualizacao" timestamptz DEFAULT CURRENT_TIMESTAMP NULL,
	CONSTRAINT enderecospacientes_pkey PRIMARY KEY (codigomaster, codigopaciente, codigoendereco),
	CONSTRAINT fk_enderecospac_foreign FOREIGN KEY (codigoendereco) REFERENCES cecom.enderecos(codigo),
	CONSTRAINT fk_enderecospacientes_foreign FOREIGN KEY (codigomaster,codigopaciente) REFERENCES cecom.pacientes(codigomaster,codigopaciente)
);

-- Permissions

ALTER TABLE cecom.enderecospacientes OWNER TO postgres;
GRANT ALL ON TABLE cecom.enderecospacientes TO postgres;


-- cecom.enderecosprofissionais definition

-- Drop table

-- DROP TABLE cecom.enderecosprofissionais;

CREATE TABLE cecom.enderecosprofissionais (
	codigoprof int4 NOT NULL,
	codigoendereco int4 NOT NULL,
	"dtAtualizacao" timestamptz DEFAULT CURRENT_TIMESTAMP NULL,
	CONSTRAINT enderecosprofissionais_pkey PRIMARY KEY (codigoprof, codigoendereco),
	CONSTRAINT fk_enderecosprof_foreign FOREIGN KEY (codigoendereco) REFERENCES cecom.enderecos(codigo),
	CONSTRAINT fk_enderecosprof_prof_foreign FOREIGN KEY (codigoprof) REFERENCES cecom.profissionais(codigoprof)
);

-- Permissions

ALTER TABLE cecom.enderecosprofissionais OWNER TO postgres;
GRANT ALL ON TABLE cecom.enderecosprofissionais TO postgres;


-- cecom.evolucoes definition

-- Drop table

-- DROP TABLE cecom.evolucoes;

CREATE TABLE cecom.evolucoes (
	cd_evolucao int4 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 2147483647 START 1 CACHE 1 NO CYCLE) NOT NULL,
	codigoprof int4 NOT NULL,
	prontuario bpchar(7) NOT NULL,
	codigomasterpac int4 NOT NULL,
	codigopaciente int4 NOT NULL,
	dt_evolucao timestamptz NULL,
	cd_tipoevolucao int2 NOT NULL,
	evolucao bytea NULL,
	cd_pessoaautorizacao int4 NULL,
	dt_autorizacao timestamptz NULL,
	dt_impressao timestamptz NULL,
	cd_motivoexclamacao int2 NULL,
	codigomasterinvalida int4 NOT NULL,
	dt_invalidacao timestamptz NULL,
	motivoinvalidacao varchar(2000) NULL,
	cd_arquivoassinado int4 NULL,
	codigomasterarq int4 NOT NULL,
	codigolocalatend int2 NOT NULL,
	CONSTRAINT evolucoes_pkey PRIMARY KEY (codigoprof, cd_evolucao),
	CONSTRAINT fk_evolucoes_arquivoass_foreign FOREIGN KEY (cd_arquivoassinado,codigomasterarq) REFERENCES cecom.arquivosassinados (cd_arquivoassinado,codigoprof),
	CONSTRAINT fk_evolucoes_locatend_foreign FOREIGN KEY (codigolocalatend) REFERENCES cecom.locaisatendimentos(codigo),
	CONSTRAINT fk_evolucoes_motivoexcla_foreign FOREIGN KEY (cd_motivoexclamacao) REFERENCES cecom.motivosexclamacao(codigo),
	CONSTRAINT fk_evolucoes_pessinval_foreign FOREIGN KEY (codigomasterinvalida) REFERENCES cecom.profissionais(codigoprof),
	CONSTRAINT fk_evolucoes_prof_foreign FOREIGN KEY (codigoprof) REFERENCES cecom.profissionais(codigoprof),
	CONSTRAINT fk_evolucoes_prontpac_foreign FOREIGN KEY (codigomasterpac,codigopaciente,prontuario) REFERENCES cecom.prontuariospacientes(codigopac,codigopaciente,prontuario),
	CONSTRAINT fk_evolucoes_tpevol_foreign FOREIGN KEY (cd_tipoevolucao) REFERENCES cecom.tiposevolucoes(codigo)
);

-- Permissions

ALTER TABLE cecom.evolucoes OWNER TO postgres;
GRANT ALL ON TABLE cecom.evolucoes TO postgres;


-- cecom.financeiro definition

-- Drop table

-- DROP TABLE cecom.financeiro;

CREATE TABLE cecom.financeiro (
	cd_financeiro int4 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 2147483647 START 1 CACHE 1 NO CYCLE) NOT NULL,
	codigoprof int4 NOT NULL,
	codigomasterpac int4 NOT NULL,
	codigopaciente int4 NOT NULL,
	qtd_parcelas int2 NOT NULL,
	valor_total money NOT NULL,
	qtd_evolucoes int2 NOT NULL,
	cd_tipoprocedimento int2 NOT NULL,
	dt_registro timestamptz NULL,
	CONSTRAINT financeiro_pkey PRIMARY KEY (cd_financeiro),
	CONSTRAINT fk_financeiro_prof_foreign FOREIGN KEY (codigoprof) REFERENCES cecom.profissionais(codigoprof),
	CONSTRAINT fk_financeiro_prontpac_foreign FOREIGN KEY (codigomasterpac,codigopaciente) REFERENCES cecom.pacientes(codigomaster,codigopaciente),
	CONSTRAINT fk_financeiro_tipoproc_foreign FOREIGN KEY (cd_tipoprocedimento) REFERENCES cecom.tiposprocedimentos(codigo)
);

-- Permissions

ALTER TABLE cecom.financeiro OWNER TO postgres;
GRANT ALL ON TABLE cecom.financeiro TO postgres;


-- cecom.itensfinanceiro definition

-- Drop table

-- DROP TABLE cecom.itensfinanceiro;

CREATE TABLE cecom.itensfinanceiro (
	cd_itenfinanceiro int4 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 2147483647 START 1 CACHE 1 NO CYCLE) NOT NULL,
	cd_financeiro int4 NOT NULL,
	numero_parcela int2 NOT NULL,
	valor_parcela money NOT NULL,
	dt_vencimento timestamptz NULL,
	CONSTRAINT itensfinanceiro_pkey PRIMARY KEY (cd_itenfinanceiro, cd_financeiro),
	CONSTRAINT fk_itensfinanceiro_fin_foreign FOREIGN KEY (cd_financeiro) REFERENCES cecom.financeiro(cd_financeiro)
);

-- Permissions

ALTER TABLE cecom.itensfinanceiro OWNER TO postgres;
GRANT ALL ON TABLE cecom.itensfinanceiro TO postgres;


-- cecom.itensfinanceirosassinaturas definition

-- Drop table

-- DROP TABLE cecom.itensfinanceirosassinaturas;

CREATE TABLE cecom.itensfinanceirosassinaturas (
	cd_itemfinanassinatura int4 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 2147483647 START 1 CACHE 1 NO CYCLE) NOT NULL,
	codigoassinante int4 NOT NULL,
	codigoplano int4 NOT NULL,
	codigoassinatura int4 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 2147483647 START 1 CACHE 1 NO CYCLE) NOT NULL,
	valor_parcela money NOT NULL,
	dt_vencimento timestamptz NULL,
	CONSTRAINT itensfinanceiroass_pkey PRIMARY KEY (cd_itemfinanassinatura),
	CONSTRAINT fk_itensfinanceiro_ass_foreign FOREIGN KEY (codigoassinante,codigoplano,codigoassinatura) REFERENCES cecom.assinaturas(codigoassinante,codigoplano,codigo)
);

-- Permissions

ALTER TABLE cecom.itensfinanceirosassinaturas OWNER TO postgres;
GRANT ALL ON TABLE cecom.itensfinanceirosassinaturas TO postgres;


-- cecom.pacienteshumor definition

-- Drop table

-- DROP TABLE cecom.pacienteshumor;

CREATE TABLE cecom.pacienteshumor (
	cd_pacientehumor int4 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 2147483647 START 1 CACHE 1 NO CYCLE) NOT NULL,
	codigopacientemaster int4 NOT NULL,
	codigopaciente int4 NOT NULL,
	dt_humor timestamptz NOT NULL,
	codigoevolucao int4 NULL,
	codigoprof int4 NULL,
	cidhumano int4 NULL,
	dsmhumano int4 NULL,
	humorintensidade int2 NOT NULL, -- 1-Péssimo; 2-Ruim; 3-Neutro, 4-Bom, 5-Ótimo
	CONSTRAINT ckc_humorintensidade_master CHECK (((humorintensidade IS NULL) OR (humorintensidade = ANY (ARRAY[1, 2, 3, 4, 5])))),
	CONSTRAINT pacienteshumor_pkey PRIMARY KEY (cd_pacientehumor, codigopacientemaster, codigopaciente),
	CONSTRAINT fk_pacienteshumor_cid_foreign FOREIGN KEY (cidhumano) REFERENCES cecom.cid_master(cd_cid_master),
	CONSTRAINT fk_pacienteshumor_dsm_foreign FOREIGN KEY (dsmhumano) REFERENCES cecom.dsm_master(cd_dsm_master),
	CONSTRAINT fk_pacienteshumor_evol_foreign FOREIGN KEY (codigoprof,codigoevolucao) REFERENCES cecom.evolucoes(codigoprof,cd_evolucao),
	CONSTRAINT fk_pacienteshumor_paciente FOREIGN KEY (codigopacientemaster,codigopaciente) REFERENCES cecom.pacientes(codigomaster,codigopaciente)
);

-- Column comments

COMMENT ON COLUMN cecom.pacienteshumor.humorintensidade IS '1-Péssimo; 2-Ruim; 3-Neutro, 4-Bom, 5-Ótimo';

-- Permissions

ALTER TABLE cecom.pacienteshumor OWNER TO postgres;
GRANT ALL ON TABLE cecom.pacienteshumor TO postgres;


-- cecom.parcelasreceber definition

-- Drop table

-- DROP TABLE cecom.parcelasreceber;

CREATE TABLE cecom.parcelasreceber (
	cd_parcelasreceber int4 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 2147483647 START 1 CACHE 1 NO CYCLE) NOT NULL,
	cd_itenfinanceiro int4 NOT NULL,
	cd_financeiro int4 NOT NULL,
	numero_parcela int2 NOT NULL,
	valor_parcela money NOT NULL,
	cd_tiporecebimento int2 NOT NULL,
	dt_pagamento timestamptz NULL,
	id_confirmacaopag varchar(50) NULL,
	CONSTRAINT parcelasreceber_pkey PRIMARY KEY (cd_parcelasreceber, cd_financeiro, cd_itenfinanceiro),
	CONSTRAINT fk_parcela_itensfinan_foreign FOREIGN KEY (cd_financeiro,cd_itenfinanceiro) REFERENCES   cecom.itensfinanceiro(cd_financeiro,cd_itenfinanceiro),
	CONSTRAINT fk_parcela_tiporeceb_foreign FOREIGN KEY (cd_tiporecebimento) REFERENCES cecom.tiposrecebimento(codigo)
);

-- Permissions

ALTER TABLE cecom.parcelasreceber OWNER TO postgres;
GRANT ALL ON TABLE cecom.parcelasreceber TO postgres;


-- cecom.parcelasreceberassinatura definition

-- Drop table

-- DROP TABLE cecom.parcelasreceberassinatura;

CREATE TABLE cecom.parcelasreceberassinatura (
	cd_parcelasreceberassinatura int4 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 2147483647 START 1 CACHE 1 NO CYCLE) NOT NULL,
	cd_itemfinanassinatura int4 NOT NULL,
	numero_parcela int2 NOT NULL,
	valor_parcela money NOT NULL,
	cd_tiporecebimento int2 NOT NULL,
	dt_pagamento timestamptz NULL,
	id_confirmacaopag varchar(50) NULL,
	CONSTRAINT parcelasreceberassinatura_pkey PRIMARY KEY (cd_parcelasreceberassinatura, cd_itemfinanassinatura),
	CONSTRAINT fk_parcela_itensfinanass_foreign FOREIGN KEY (cd_itemfinanassinatura) REFERENCES cecom.itensfinanceirosassinaturas(cd_itemfinanassinatura),
	CONSTRAINT fk_parcela_tiporecebass_foreign FOREIGN KEY (cd_tiporecebimento) REFERENCES cecom.tiposrecebimento(codigo)
);

-- Permissions

ALTER TABLE cecom.parcelasreceberassinatura OWNER TO postgres;
GRANT ALL ON TABLE cecom.parcelasreceberassinatura TO postgres;


-- cecom.evolucoesfinanceiro definition

-- Drop table

-- DROP TABLE cecom.evolucoesfinanceiro;

CREATE TABLE cecom.evolucoesfinanceiro (
	cd_evolucaofinanceiro int4 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 2147483647 START 1 CACHE 1 NO CYCLE) NOT NULL,
	cd_financeiro int4 NOT NULL,
	cd_evolucao int4 NOT NULL,
	codigoprof int4 NOT NULL,
	codigomasterpac int4 NOT NULL,
	codigopaciente int4 NOT NULL,
	CONSTRAINT evolucoesfinanceiro_pkey PRIMARY KEY (cd_evolucaofinanceiro),
	CONSTRAINT evolucoesfinanceiro_unique UNIQUE (cd_evolucao, codigoprof, cd_financeiro, codigomasterpac, codigopaciente),
	CONSTRAINT fk_evolfinan_evol_foreign FOREIGN KEY (cd_evolucao,codigoprof) REFERENCES cecom.evolucoes(cd_evolucao,codigoprof),
	CONSTRAINT fk_evolfinan_finan_foreign FOREIGN KEY (cd_financeiro) REFERENCES cecom.financeiro(cd_financeiro),
	CONSTRAINT fk_evolfinan_pac_foreign FOREIGN KEY (codigomasterpac,codigopaciente) REFERENCES cecom.pacientes(codigomaster,codigopaciente)
);

-- Permissions

ALTER TABLE cecom.evolucoesfinanceiro OWNER TO postgres;
GRANT ALL ON TABLE cecom.evolucoesfinanceiro TO postgres;